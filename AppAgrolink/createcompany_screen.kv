#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import MDApp kivymd.app.MDApp
#:import MDTopAppBar kivymd.uix.toolbar.MDTopAppBar
#:import MDNavigationDrawer kivymd.uix.navigationdrawer.MDNavigationDrawer
#:import MDFlatButon kivymd.uix.button.MDFlatButton
#:import MDRaisedButton kivymd.uix.button.MDRaisedButton
#:import MDLabel kivymd.uix.label.MDLabel
#:import MDIconButton kivymd.uix.button.MDIconButton
#:import MDTextField kivymd.uix.textfield.MDTextField
#:import MDFloatingActionButton kivymd.uix.button.MDFloatingActionButton
#:import MDNavigationLayout kivymd.uix.navigationdrawer.MDNavigationLayout
#:import ScreenManager kivy.uix.screenmanager.ScreenManager
#:import Screen kivy.uix.screenmanager.Screen

<CreateCompany>:
    MDNavigationLayout:
        ScreenManager:
            Screen:
                BoxLayout:
                    orientation: 'vertical'
                    color: 0, 0.5, 0, 1
                    MDTopAppBar:
                        title: 'AgroLink'
                        left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]
                        elevation:10 
                        md_bg_color: [0.29411, 0.6353, 0.4157, 1]
                    BoxLayout:    
                        size_hint_y: 0.05
                    BoxLayout:
                        ScrollView:
                            do_scroll_x: False  # Desativar rolagem horizontal
                            do_scroll_y: True   # Ativar rolagem vertical

                            GridLayout:
                                id: form_layout
                                size_hint_y: None
                                width: self.parent.width
                                height: self.minimum_height  # Importante para expandir com o conteúdo
                                cols: 1
                                spacing: '10dp'
                                padding: '10dp'

                                Label:
                                    text: 'Nome da Empresa:'
                                    size_hint_y: None
                                    height: '30dp'
                                    color: 0, 0.5, 0, 1        

                                TextInput:
                                    id: nomeempresa
                                    size_hint_y: None
                                    height: '48dp'
                                    padding: [10, 10, 10, 10]  # Substituição de padding_x

                                Label:
                                    text: 'Número de Contribuinte:'
                                    size_hint_y: None
                                    height: '30dp'
                                    color: 0, 0.5, 0, 1        

                                TextInput:
                                    id: numerocontribuinte
                                    size_hint_y: None
                                    height: '48dp'
                                    padding: [10, 10, 10, 10]  # Substituição de padding_x

                                Label:
                                    text: 'Morada:'
                                    size_hint_y: None
                                    height: '30dp'
                                    color: 0, 0.5, 0, 1        

                                TextInput:
                                    id: morada
                                    size_hint_y: None
                                    height: '48dp'
                                    padding: [10, 10, 10, 10]  # Substituição de padding_x

                                Label:
                                    text: 'Contacto:'
                                    size_hint_y: None
                                    height: '30dp'
                                    color: 0, 0.5, 0, 1    

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint_y: None
                                    height: '48dp'
                                    spacing: '10dp'

                                    
                                    Spinner:
                                        id: paiscontacto
                                        text: '+351'  # Valor inicial do Spinner
                                        values: ['+351', '+34', '+39', '+33', '+41']  # Valores possíveis para o Spinner de paises
                                        size_hint_x: None
                                        width: 100
                                        background_color: (1, 1, 1, 0)  # Fundo transparente do Spinner propriamente dito
                                        color: (0, 0.5, 0, 1)  # Cor do texto
                                        canvas.before:
                                            Color:
                                                rgba: (0.9, 0.9, 0.9, 1)  # Cor de fundo clara para o retângulo arredondado
                                            RoundedRectangle:
                                                pos: self.pos
                                                size: self.size
                                                radius: [10]  # Cantos arredondados


                                    TextInput:
                                        id: contacto
                                        hint_text: 'Digite o Contacto'
                                        padding: [10, 10, 10, 10]  # Substituição de padding_x
                                        size_hint_x: 1  # Preencher o espaço restante
                                        input_filter: 'int'
                            
                            # Adicionar aqui campos para colocar vários parametros a serem introduzidos

                                Button:
                                    text: 'Próximo'
                                    size_hint_y: None
                                    height: '50dp'
                                    on_release:
                                        root.criar()
                                        app.root.transition = SlideTransition(direction='left', duration=0)
                                        app.root.current = app.root.current = 'firstapppage'
                                    background_color: 1, 1, 1, 0
                                    color: 1, 1, 1, 1  # Cor do texto branco
                                    canvas.before:
                                        Color:
                                            rgba: 0, 0.5, 0, 0.8
                                        RoundedRectangle:
                                            pos: self.pos
                                            size: self.size
                                            radius: [40]  # Cantos arredondados




        MDNavigationDrawer:
            id: nav_drawer
            md_bg_color: [1, 1, 1, 0.8]
            BoxLayout:
                orientation: 'vertical'
                spacing: '8dp'
                padding: '3dp'

                Image:
                    source: 'assets/agrolink.png'
                    size_hint_y: None  # Tells the layout to ignore the size_hint in y dir
                    height: dp(140)  # The fixed height you want
                MDLabel:
                    text: '    Agrolink'
                    bold: True
                    font_style: 'Subtitle1'
                    size_hint_y: None
                    height: self.texture_size[1]
                  

                ScrollView:
                    MDList:
                        OneLineIconListItem:
                            text: 'Relatórios'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'firstapppage'
                            IconLeftWidget:
                                icon: 'paperclip'
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'firstapppage'
                        OneLineIconListItem:
                            text: 'Sensores'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'firstapppage'
                            IconLeftWidget:
                                icon: 'access-point-network'
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'firstapppage'  
                        OneLineIconListItem:
                            text: 'Frações'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'firstapppage'
                            IconLeftWidget:
                                icon: 'terrain'  
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'firstapppage'
                        OneLineIconListItem:
                            text: 'Comunicados'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'firstapppage'
                            IconLeftWidget:
                                icon: 'file-clock'
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'firstapppage'
                        OneLineIconListItem:
                            text: 'Termos e Condições'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'firstapppage'
                            IconLeftWidget:
                                icon: 'alert'
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'firstapppage'
                        OneLineIconListItem:
                            text: 'Terminar Sessão'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'home'
                            IconLeftWidget:
                                icon: 'door-closed-lock'   
                                on_release:
                                    nav_drawer.set_state() 
                                    app.root.current = 'home'
                        OneLineIconListItem:
                            text: 'Validar Utilizadores'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'validateusers'
                            IconLeftWidget:
                                icon: 'account-check'   
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'validateusers'
                        OneLineIconListItem:
                            text: 'Criar Empresa'
                            on_release: 
                                nav_drawer.set_state()
                                app.root.current = 'createcompany'
                            IconLeftWidget:
                                icon: 'web'  
                                on_release: 
                                    nav_drawer.set_state()
                                    app.root.current = 'createcompany'            
